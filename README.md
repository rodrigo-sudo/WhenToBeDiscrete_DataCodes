---
title: "Replication Data and Codes"
author: "Katarzyna Bie≈Ñ-Barkowska & Rodrigo Herrera"
date: "7 April 2025"
output: html_document
---

## üìç Article Title
**"When to Be Discrete: The Importance of Time Formulation in the Modeling of Extreme Events in Finance"**  
**Authors:**  
Katarzyna Bie≈Ñ-Barkowska, Institute of Econometrics, Warsaw School of Economics  
_Email:_ katarzyna.bien@sgh.waw.pl  
Rodrigo Herrera, Faculty of Economics and Business, University of Talca  
_Email:_ rodrigo.herrera@utalca.cl

---

## üìÇ Structure of the Reproducibility Package

### `data/`
- Contains daily log return data in both `.xls` and `.dat` formats:
  - Dow Jones 30 index: `DowJones.xlsx` / `DowJones.dat`
  - S&P 500 index: `SP500.xlsx` / `SP500.dat`
  - NASDAQ Composite index: `NASDAQ.xlsx` / `NASDAQ.dat`
  - Wilshire 5000 index: `Wilshire.xlsx` / `Wilshire.dat`
- Dates in column A (2 Jan 1981 ‚Äì 30 Dec 2022), returns in column N
- Includes initial parameter values for MLE (Gauss)

### `output_data/`
- Intermediate datasets for estimation and simulation

### `replicated_results/`
- Figures and tables replicated from the manuscript
- _Exception: `Table 1/` contains the fixed extremal index estimates_

---

## üìä Software Used

- **Matlab R2024b** with Statistics and Machine Learning Toolbox  
  License: 40950635 | User: Katarzyna Bie≈Ñ-Barkowska (SGH)

- **APTECH Gauss 24** with Maxlik & CML modules  
  License: 16916856989 | User: Katarzyna Bie≈Ñ-Barkowska (SGH)

- **R 4.4.3** with packages:
  - `this.path`, `rugarch`, `esback`, `evd`, `readxl` (versions as of 1 April 2025)

---

## üìì Replication Instructions

### Matlab Scripts
- `Figure_1_2.m`: Uses Excel data from `data/`; replicates Figures 1 and 2
- `Figure_3.m` & `Figure_4.m`: No data needed; output to `replicated_results/`
- `Figure_5.m` / `Figure_D12.m`: Uses Monte Carlo datasets from `output_data/Simulation`; generated by `Monte_Carlo_Simulation.gss`
- `Figure_6_and_9.m`: Uses Hoga scores; datasets generated by `Estimation_of_SPOT_models_for_different_u_levels.gss`
- `Figure_7_8.m`: Uses VaR, hazard, conditional expectation datasets; requires `Estimation_of_SPOT_models_for_best_u_level.gss` with `printout = 1`
- `Figure_10.m`: Uses output from `Estimation_of_GARCH_models_and_inference.R`
- `Figure_C11.m`: No external data used

### Gauss Scripts
- `Estimation_of_SPOT_models_for_best_u_level.gss`: Replicates Table 3 and Table G6 using `.dat` datasets; output as `Replicated_Table3_and_Table_G6.txt`
- `Estimation_of_SPOT_models_for_different_u_levels.gss`: Generates datasets for varying thresholds

### R Script
- `Estimation_of_GARCH_models_and_inference.R`: Estimates GARCH models using `rugarch`; replicates Table 4, 5, and G7:
  - Outputs: `Replicated_Table_4.txt`, `Replicated_Table_5.txt`, `Replicated_Table_G7.txt`

_All scripts can be executed in any order._

---

## ‚è≥ Computation Times

Executed on: Intel(R) Core(TM) i7-14700KF @ 3.40 GHz | 32 GB RAM | Windows 11 Home  
_Parallel computing not used._

| Script/File                                               | Time           |
|----------------------------------------------------------|----------------|
| `Figure_1_2.m`                                           | 1.45 sec       |
| `Figure_3.m`                                             | 7.68 sec       |
| `Figure_4.m`                                             | 1.30 sec       |
| `Figure_5.m`                                             | 1.49 sec       |
| `Figure_6_and_9.m`                                       | 4.10 sec       |
| `Figure_7_8.m`                                           | 4.87 sec       |
| `Figure_10.m`                                            | 2.21 sec       |
| `Figure_C11.m`                                           | 4.24 sec       |
| `Figure_D12.m`                                           | 1.14 sec       |
| `Estimation_of_SPOT_models_for_best_u_level.gss`        | 4 min 45 sec   |
| `Estimation_of_SPOT_models_for_different_u_levels.gss`  | 2h 44m 28s     |
| `Estimation_of_GARCH_models_and_inference.R`            | 15 min         |

